<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lake Winnipesaukee Weather Cams</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #000;
  color: #fff;
  text-align: center;
  overflow-x: hidden;
}

h1 {
  padding-top: 20px;
  margin-bottom: 10px;
  position: relative;
  z-index: 2;
}

.description {
  margin-bottom: 20px;
  font-size: 18px;
  color: #ccc;
  position: relative;
  z-index: 2;
}

.weather-bar {
  margin-bottom: 40px;
  font-size: 16px;
  color: #9fd3ff;
  position: relative;
  z-index: 2;
}

.cam-container {
  display: flex;
  justify-content: center;
  gap: 40px;
  flex-wrap: wrap;
  padding-bottom: 60px;
  position: relative;
  z-index: 2;
}

.cam-box {
  width: 600px;
  height: 600px;
  background: #111;
  border: 2px solid #444;
  display: flex;
  flex-direction: column;
}

.cam-box h2 {
  margin: 10px 0;
}

iframe, img, video {
  flex: 1;
  width: 100%;
  height: 100%;
  border: none;
  object-fit: cover;
}

#snowCanvas {
  position: fixed;
  top: 0;
  left: 0;
  pointer-events: none;
  z-index: 0;
}
</style>
</head>
<body>

<canvas id="snowCanvas"></canvas>

<h1>Lake Winnipesaukee Weather Cams</h1>
<div class="description">
View live cams around Lake Winnipesaukee in one place to gauge the weather conditions!
</div>

<div class="weather-bar" id="weatherInfo">
Loading Wolfeboro weather...
</div>

<div class="cam-container">

  <!-- YouTube Cam -->
  <div class="cam-box">
    <h2>YouTube Cam</h2>
    <iframe
      src="https://www.youtube.com/embed/ChLc41PxUWc?autoplay=1&mute=1&controls=1"
      allow="autoplay; fullscreen"
      allowfullscreen>
    </iframe>
  </div>

  <!-- Center Harbor Cam -->
  <div class="cam-box">
    <h2>Lake Winnipesaukee – Center Harbor Inn</h2>
    <img id="centerHarborCam" src="https://cam.centerharborinn.com/jpg/1/image.jpg">
  </div>

  <!-- Snake Eyes Cam -->
  <div class="cam-box">
    <h2>Snake Eyes</h2>
    <img id="snakeEyesCam" src="https://images.weserv.nl/?url=www.rattlesnakecam.com/snake_eyes.jpg">
  </div>

  <!-- Piping Rock Resort -->
  <div class="cam-box">
    <h2>Piping Rock Resort</h2>
    <video id="pipingRock" controls autoplay muted playsinline></video>
  </div>

  <!-- Mt Washington Cog -->
  <div class="cam-box">
    <h2>Mt. Washington Cog</h2>
    <iframe
      src="https://www.youtube.com/embed/k0Dp4c-VQEQ?autoplay=1&mute=1"
      allow="autoplay; fullscreen"
      allowfullscreen>
    </iframe>
  </div>

</div>

<!-- HLS.js for .m3u8 playback -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<script>
// Wolfeboro weather
const lat = 43.5867;
const lon = -71.2148;

fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&temperature_unit=fahrenheit&windspeed_unit=mph`)
  .then(res => res.json())
  .then(data => {
    const weather = data.current_weather;
    document.getElementById("weatherInfo").innerHTML =
      `Wolfeboro, NH — Temp: ${weather.temperature}°F | Wind: ${weather.windspeed} MPH`;
  })
  .catch(() => {
    document.getElementById("weatherInfo").innerHTML =
      "Weather data unavailable.";
  });

// Refresh Center Harbor
const centerHarborCam = document.getElementById("centerHarborCam");
setInterval(() => {
  centerHarborCam.src =
    `https://cam.centerharborinn.com/jpg/1/image.jpg?${Date.now()}`;
}, 5000);

// Refresh Snake Eyes
const snakeEyesCam = document.getElementById("snakeEyesCam");
setInterval(() => {
  snakeEyesCam.src =
    `https://images.weserv.nl/?url=www.rattlesnakecam.com/snake_eyes.jpg&${Date.now()}`;
}, 5000);

// Piping Rock HLS Stream
const video = document.getElementById('pipingRock');
const streamUrl = "https://s59.ipcamlive.com/streams/3bzlrsgmsxuxhwp9i/stream.m3u8";

if (Hls.isSupported()) {
  const hls = new Hls();
  hls.loadSource(streamUrl);
  hls.attachMedia(video);
} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
  video.src = streamUrl;
}

// Snow animation
const canvas = document.getElementById("snowCanvas");
const ctx = canvas.getContext("2d");
let width, height;
let snowflakes = [];

function resizeCanvas() {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

function createSnowflakes() {
  snowflakes = [];
  for (let i = 0; i < 150; i++) {
    snowflakes.push({
      x: Math.random() * width,
      y: Math.random() * height,
      radius: Math.random() * 3 + 1,
      speed: Math.random() * 1 + 0.5,
      drift: Math.random() * 0.5 - 0.25
    });
  }
}

function drawSnowflakes() {
  ctx.clearRect(0, 0, width, height);
  ctx.fillStyle = "white";
  ctx.beginPath();
  snowflakes.forEach(flake => {
    ctx.moveTo(flake.x, flake.y);
    ctx.arc(flake.x, flake.y, flake.radius, 0, Math.PI * 2);
  });
  ctx.fill();
  moveSnowflakes();
}

function moveSnowflakes() {
  snowflakes.forEach(flake => {
    flake.y += flake.speed;
    flake.x += flake.drift;
    if (flake.y > height) {
      flake.y = 0;
      flake.x = Math.random() * width;
    }
  });
}

function updateSnow() {
  drawSnowflakes();
  requestAnimationFrame(updateSnow);
}

createSnowflakes();
updateSnow();
</script>

</body>
</html>
